<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>SkyBard - Music Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">üéµ <span>Sky</span>Bard</div>
            <ul class="nav-menu">
                <li class="nav-item active" id="nav-store" onclick="switchTab('store')">üè† C·ª≠a h√†ng</li>
                <li class="nav-item" id="nav-library" onclick="switchTab('library')">üìö Th∆∞ vi·ªán</li>
                <li class="nav-item" id="nav-settings" onclick="switchTab('settings')">‚öôÔ∏è C√†i ƒë·∫∑t</li>
            </ul>
            <div class="user-profile">
                <div class="user-name" id="usernameDisplay">Kh√°ch</div>
                <div class="user-coin">üí∞ <span id="userCoinDisplay">0</span> xu</div>
            </div>
        </aside>

        <main class="main-content">

            <div id="view-store" class="view-section active">
                <div class="header-bar">
                    <h3 class="section-title">C·ª≠a h√†ng nh·∫°c</h3>
                    <input type="text" class="search-input" placeholder="üîç T√¨m b√†i h√°t...">
                </div>
                <div id="storeList" class="song-grid">
                    <div style="color: #888;">‚è≥ ƒêang t·∫£i kho nh·∫°c...</div>
                </div>
            </div>

            <div id="view-library" class="view-section">
                <div class="header-bar">
                    <h3 class="section-title">Th∆∞ vi·ªán c·ªßa t√¥i</h3>
                    <input type="text" class="search-input" placeholder="üîç T√¨m b√†i h√°t...">
                </div>

                <div class="library-tabs">
                    <button class="library-tab active" id="tab-all" onclick="switchLibraryTab('all')">üìÅ T·∫•t c·∫£</button>
                    <button class="library-tab" id="tab-favorites" onclick="switchLibraryTab('favorites')">‚ù§Ô∏è Y√™u
                        th√≠ch</button>
                </div>

                <div id="library-all" class="library-content active">
                    <div id="libList" class="song-grid">
                        <div style="color: #888; font-style: italic;">B·∫°n ch∆∞a mua b√†i n√†o c·∫£.</div>
                    </div>
                </div>

                <div id="library-favorites" class="library-content">
                    <div id="favList" class="song-grid">
                        <div style="color: #888; font-style: italic;">Ch∆∞a c√≥ b√†i h√°t y√™u th√≠ch.</div>
                    </div>
                </div>
            </div>

            <div id="view-settings" class="view-section">
                <h3 class="section-title" style="margin-bottom: 20px;">C·∫•u h√¨nh H·ªá th·ªëng</h3>

                <div class="settings-group">
                    <div class="settings-row">
                        <span>üöÄ T·ªëc ƒë·ªô ch∆°i nh·∫°c (Speed)</span>
                        <input type="range" min="0.5" max="2.0" step="0.1" value="1.0">
                    </div>
                    <div class="settings-row">
                        <span>üéπ Ch·∫ø ƒë·ªô nh·∫•n gi·ªØ (Long-press Mode)</span>
                        <input type="checkbox">
                    </div>
                </div>

                <div class="settings-group">
                    <div class="settings-row">
                        <span>üë§ T√†i kho·∫£n hi·ªán t·∫°i</span>
                        <span style="color: #f1c40f;" id="settingUsername">...</span>
                    </div>
                    <button class="btn-logout">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>

        </main>
    </div>

    <footer class="player-bar">
        <div class="player-left">
            <div class="song-info">
                <div class="song-title" id="statusTitle">Ch∆∞a ch·ªçn b√†i</div>
                <div class="song-artist" id="statusSub">S·∫µn s√†ng</div>
            </div>
        </div>

        <div class="player-center">
            <div class="player-actions">
                <button class="btn-mode active" id="btnPlaybackMode" data-mode="once" title="Ph√°t 1 b√†i r·ªìi d·ª´ng">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="icon-once">
                        <path d="M5 12h14M14 5l7 7-7 7" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        class="icon-sequence" style="display:none;">
                        <path d="M17 1l4 4-4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M3 11V9a4 4 0 0 1 4-4h14" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M7 23l-4-4 4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M21 13v2a4 4 0 0 1-4 4H3" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        class="icon-shuffle" style="display:none;">
                        <path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        class="icon-repeatone" style="display:none;">
                        <path d="M17 1l4 4-4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M3 11V9a4 4 0 0 1 4-4h14" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <path d="M7 23l-4-4 4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M21 13v2a4 4 0 0 1-4 4H3" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <text x="12" y="15" font-size="8" text-anchor="middle" font-weight="bold" fill="currentColor"
                            stroke="none">1</text>
                    </svg>
                </button>

                <div class="main-controls">
                    <button class="btn-control" id="btnPrev" title="B√†i tr∆∞·ªõc">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M3 2h2v12H3V2zm11 0l-9 6 9 6V2z" />
                        </svg>
                    </button>
                    <button class="btn-control btn-play" id="btnMainPlay" title="Ph√°t/T·∫°m d·ª´ng">
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M3 2l10 6-10 6V2z" />
                        </svg>
                    </button>
                    <button class="btn-control" id="btnNext" title="B√†i ti·∫øp">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M11 2h2v12h-2V2zM2 2l9 6-9 6V2z" />
                        </svg>
                    </button>
                </div>

                <div class="speed-control">
                    <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8 2C4.7 2 2 4.7 2 8s2.7 6 6 6 6-2.7 6-6-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z" />
                        <path d="M7.5 5h1v4l2.5 1.5-.5.8-3-1.8V5z" />
                    </svg>
                    <input type="number" id="speedInput" min="0.5" max="2.0" step="0.1" value="1.0"
                        title="T·ªëc ƒë·ªô ph√°t (0.5 - 2.0)">
                </div>
            </div>

            <div class="progress-section">
                <span class="time-current" id="timeNow">0:00</span>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <span class="time-total" id="timeTotal">0:00</span>
            </div>
        </div>

        <div class="player-right">
            <button class="btn-add" id="btnAdd" title="Th√™m b√†i h√°t v√†o danh s√°ch">
                <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 2v12M2 8h12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>
    </footer>

    <script>
        function switchTab(tabName) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById('view-' + tabName).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + tabName).classList.add('active');
        }

        const playbackModes = ['once', 'sequence', 'shuffle', 'repeat-one'];
        const modeNames = {
            'once': 'Ph√°t 1 b√†i r·ªìi d·ª´ng',
            'sequence': 'Ph√°t l·∫ßn l∆∞·ª£t',
            'shuffle': 'Ph√°t ng·∫´u nhi√™n',
            'repeat-one': 'L·∫∑p 1 b√†i'
        };
        let currentModeIndex = 0;

        const btnPlaybackMode = document.getElementById('btnPlaybackMode');

        function updatePlaybackMode() {
            const mode = playbackModes[currentModeIndex];
            btnPlaybackMode.setAttribute('data-mode', mode);
            btnPlaybackMode.setAttribute('title', modeNames[mode]);

            btnPlaybackMode.querySelectorAll('svg').forEach(svg => svg.style.display = 'none');

            const iconClass = '.icon-' + mode.replace('-', '');
            const icon = btnPlaybackMode.querySelector(iconClass);
            if (icon) icon.style.display = 'block';

            btnPlaybackMode.classList.add('active');
        }

        btnPlaybackMode?.addEventListener('click', () => {
            currentModeIndex = (currentModeIndex + 1) % playbackModes.length;
            updatePlaybackMode();
        });

        function switchLibraryTab(tabName) {
            document.querySelectorAll('.library-content').forEach(el => el.classList.remove('active'));
            document.getElementById('library-' + tabName).classList.add('active');

            document.querySelectorAll('.library-tab').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        let currentSong = null;
        let isPlaying = false;

        function onSongCardClick(songData, isOwned) {
            if (!isOwned) {
                return;
            }

            currentSong = songData;
            document.getElementById('statusTitle').textContent = songData.title || 'Ch∆∞a r√µ t√™n';
            document.getElementById('statusSub').textContent = songData.artist || 'Ngh·ªá sƒ© kh√¥ng r√µ';
            
            isPlaying = false;
            updatePlayButton();
        }

        function updatePlayButton() {
            const btnPlay = document.getElementById('btnMainPlay');
            const svg = btnPlay.querySelector('svg');
            
            if (isPlaying) {
                svg.innerHTML = '<path d="M5 2h2v12H5V2zm4 0h2v12H9V2z" />';
                btnPlay.setAttribute('title', 'T·∫°m d·ª´ng');
            } else {
                svg.innerHTML = '<path d="M3 2l10 6-10 6V2z" />';
                btnPlay.setAttribute('title', 'Ph√°t');
            }
        }

        document.getElementById('btnMainPlay')?.addEventListener('click', () => {
            if (!currentSong) {
                alert('Vui l√≤ng ch·ªçn b√†i h√°t tr∆∞·ªõc!');
                return;
            }

            isPlaying = !isPlaying;
            updatePlayButton();

            if (isPlaying) {
                console.log('ƒêang ph√°t:', currentSong);
                document.getElementById('statusSub').textContent = '‚ñ∂ ƒêang ph√°t...';
                
                if (window.api && currentSong.songNotes) {
                    window.api.playOnline(currentSong.songNotes);
                }
            } else {
                console.log('T·∫°m d·ª´ng:', currentSong);
                document.getElementById('statusSub').textContent = '‚è∏ ƒê√£ t·∫°m d·ª´ng';
                
                if (window.api) {
                    window.api.stopMusic();
                }
            }
        });

        window.onSongCardClick = onSongCardClick;
    </script>

    <script type="module" src="renderer.js"></script>
</body>

</html>